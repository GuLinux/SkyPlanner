set(DOCKER_BUILD_TYPE Debug CACHE STRING "Docker images CMAKE_BUILD_TYPE (default: Debug)")
set(DOCKER_BUILD_JOBS 1 CACHE STRING "Docker images make jobs number (default: 1)")
configure_file(${CMAKE_CURRENT_SOURCE_DIR}/Dockerfile Dockerfile @ONLY)
set(DOCKER_IMAGE_NAME skyplanner-ubuntu-build-img-${DOCKER_SUFFIX})
set(DOCKER_CONTAINER_NAME skyplanner-ubuntu-build-${DOCKER_SUFFIX})
add_custom_command(OUTPUT docker_clean_ubuntu_build_img COMMAND ${CMAKE_CURRENT_SOURCE_DIR}/../docker-cleanup-container ${DOCKER_CONTAINER_NAME} )
add_custom_command(OUTPUT docker_ubuntu_build_img COMMAND docker build -t ${DOCKER_IMAGE_NAME} . DEPENDS docker_clean_ubuntu_build_img)
add_custom_target(docker_create_build_container_ubuntu COMMAND docker create -v ${CMAKE_SOURCE_DIR}:/SkyPlanner:ro -v ${CMAKE_CURRENT_BINARY_DIR}/..:/SkyPlanner-dist --name ${DOCKER_CONTAINER_NAME} ${DOCKER_IMAGE_NAME} DEPENDS docker_ubuntu_build_img)
add_custom_target(docker_build_ubuntu COMMAND docker start -a -i ${DOCKER_CONTAINER_NAME})